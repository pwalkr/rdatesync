<html><head><title>Usage</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018002 at Sat Jan 30 17:44:59 2016 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u'
name="Usage"
>Usage</a></h1>

<p>Rdatesync runs with a configuration file as an argument.
For details on the what the contents of this file should be,
run without arguments.</p>

<h2><a class='u'
name="TestUsageOutput"
>TestUsageOutput</a></h2>

<p>If run without arguments,
rdatesync.pl should print usage.</p>

<h1><a class='u'
name="Configuration"
>Configuration</a></h1>

<p>Configure rdatesync.pl by giving it a config file as an argument.
This file must be of the format:</p>

<pre>        destination /path/to/backups/destination
        backup /path/to/backup
        backup /path/to/another/backup
        backup ...</pre>

<h2><a class='u'
name="TestConfigRead"
>TestConfigRead</a></h2>

<p>By default, rdatesync.pl will print the contents of its configuration as it parses the config. This allows a test to confirm that it is reading the config correctly.</p>

<h2><a class='u'
name="TestConfigComments"
>TestConfigComments</a></h2>

<p>Comments should be ignored.</p>

<h2><a class='u'
name="TestConfigTrailingSlash"
>TestConfigTrailingSlash</a></h2>

<p>rsync behaves differently if the source directories have trailing slashes.</p>

<p>To back up local/source/file,</p>

<pre>        rsync local/source remote</pre>

<p>will produce</p>

<pre>        remote/source/file</pre>

<p>whereas</p>

<pre>        rsync local/source/ remote</pre>

<p>will produce</p>

<pre>        remote/file</pre>

<p>To avoid potential name conflicts between the contents of a backup and a separate backup, rdatesync.pl should strip any trailing slash</p>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<pre>        Print ERROR message that a backup had a trailing slash</pre>

<h2><a class='u'
name="TestConfigDuplicateBackup"
>TestConfigDuplicateBackup</a></h2>

<p>Since rsync produces a directory containing the basename of each source input, these two backups:</p>

<pre>        destination /archive
        backup /source/mybackup
        backup /source/subdir/mybackup</pre>

<p>Would produce a single <code>/archive/yyyy-mm-dd/mybackup</code> directory with a combination of contents from both backup directories. This is unpredictable.</p>

<p>rdatesync.pl will take the first instance of an <i>mybackup</i> and issue a warning if it needs to skip a subsequent directory.</p>

<h2><a class='u'
name="TestConfigDuplicateBackup"
>TestConfigDuplicateBackup</a></h2>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<h2><a class='u'
name="TestConfigNoDestination"
>TestConfigNoDestination</a></h2>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<pre>        Warn user that no destination was configured</pre>

<h2><a class='u'
name="TestConfigNoBackups"
>TestConfigNoBackups</a></h2>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<pre>        Warn no backups were specified or no specified backups were present.</pre>

<h1><a class='u'
name="Backups"
>Backups</a></h1>

<h2><a class='u'
name="TestFirstBackup"
>TestFirstBackup</a></h2>

<p>The first backup (and each day&#39;s backup) will produce a folder with today&#39;s date (yyyy-mm-dd) and a sub-folder for each backup in the config. E.g.</p>

<p>backups.conf:</p>

<pre>        destination /archive
        backup /source/myfolder</pre>

<p>Will produce (if run on January 2nd, 2000):</p>

<pre>        /archive/2000-01-02/myfolder</pre>

<h2><a class='u'
name="TestPathSpacesQuotes"
>TestPathSpacesQuotes</a></h2>

<p>Spaces in paths are notorious for breaking things. Test that we can back up using a destination and backups with spaces in the path names</p>

<p>The following are tested:</p>

<dl>
<dt><a name="Destination_path_contains_a_space"
>Destination path contains a space</a></dt>

<dd>
<dt><a name="Backup_path_contains_a_space"
>Backup path contains a space</a></dt>

<dd>
<dt><a name="Backup_basename_contains_a_space"
>Backup basename contains a space</a></dt>
</dl>

<h2><a class='u'
name="TestMultiBackup"
>TestMultiBackup</a></h2>

<p>Multiple folders can be backed up to destination by specifying additional &#34;backup&#34; options in the configuration file</p>

<h2><a class='u'
name="TestSecondBackupNoChange"
>TestSecondBackupNoChange</a></h2>

<p>If a file has not changed between backups, a hard link can be used to avoid duplicating data on the disk. This significantly reduces the disk space needed to store multiple days. Rsync can do this using the --link-dest argument</p>

<p>Test passes if inodes match between today/yesterday for all files.</p>

<h2><a class='u'
name="TestResults"
>TestResults</a></h2>

<p>Specify a directory with the following line in rdatesync conf to produce an itemized list of changes:</p>

<pre>        results /path/to/dir</pre>

<p>rdatesync.pl will generate itemized lists of changes in that directory</p>

<h2><a class='u'
name="TestLinkMostRecent"
>TestLinkMostRecent</a></h2>

<p>rdatesync.pl should link against the most recent backup (E.g. that the existing backups are sorted correctly)</p>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<h2><a class='u'
name="TestRerunBackup"
>TestRerunBackup</a></h2>

<p>If the backup is re-run on the same day... bail out or re-run?</p>

<h3><a class='u'
name="TODO"
>TODO</a></h3>

<h2><a class='u'
name="TestMaxDays_-_test_that_&#34;days_X&#34;_means_no_more_than_X_days_are_backed_up"
>TestMaxDays - test that &#34;days X&#34; means no more than X days are backed up</a></h2>

<h1><a class='u'
name="Utility_Functions"
>Utility Functions</a></h1>

<h2><a class='u'
name="_chompc"
>_chompc</a></h2>

<p>Run command and chomp newline off of output. Return STDOUT</p>

<h2><a class='u'
name="_dirname"
>_dirname</a></h2>

<p>Return a path with all preceding directories removed (.*/)</p>

<h2><a class='u'
name="_inode"
>_inode</a></h2>

<p>Return the inode number of a file. -1 if missing</p>

<h2><a class='u'
name="_md5sum"
>_md5sum</a></h2>

<p>Return the md5sum of a file. Otherwise undefined</p>

<h2><a class='u'
name="_mkfile"
>_mkfile</a></h2>

<p>Make a file and seed with its name as contents</p>

<h2><a class='u'
name="_writeconf"
>_writeconf</a></h2>

<p>Generate a configuration file from input destination and backup list. Return a file path string that can be used with <a href="#_runconf" class="podlinkpod"
>&#34;_runconf&#34;</a></p>

<h2><a class='u'
name="_runconf"
>_runconf</a></h2>

<p>Run rdatesync.pl with a configuration file. E.g. one generated by <a href="#_writeconf" class="podlinkpod"
>&#34;_writeconf&#34;</a></p>

<!-- end doc -->

</body></html>
